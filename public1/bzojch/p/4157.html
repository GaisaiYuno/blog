<html>
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>4157：星际瘟疫</title>
	<!-- css -->
	<link href="../css/base.min.css" rel="stylesheet">
	<link href="../css/project.min.css" rel="stylesheet">
	
	<!-- favicon -->
	<!-- ... -->
</head>
<body class="page-brand">
	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left">
			<li>
				<a data-toggle="menu" href="4157.html#menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<a class="header-logo header-affix-hide margin-left-no margin-right-no" data-offset-top="213" data-spy="affix">星际瘟疫</a>
		<span class="header-logo header-affix margin-left-no margin-right-no" data-offset-top="213" data-spy="affix">星际瘟疫</span>
	</header>
	<nav aria-hidden="true" class="menu" id="menu" tabindex="-1">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="../index.html">BZOJ离线题库</a>
				<ul class="nav">
					<li>
						<a class="waves-attach" data-toggle="collapse" href="4157.html#problems">题目</a>
						<ul class="menu-collapse collapse in" id="problems">
							<li>
								<a class="waves-attach" href="../index.html">主页</a>
							</li>
							<li>
								<a class="waves-attach" href="../list.html">题目列表</a>
							</li>
						</ul>
					</li>
					<li>
						<a class="collapsed waves-attach" data-toggle="collapse" href="4157.html#about">关于</a>
						<ul class="menu-collapse collapse" id="about">
							<li>
								<a class="waves-attach" href="../about.html">关于此项目</a>
							</li>
						</ul>
					</li>
					
				</ul>
			</div>
		</div>
	</nav>
	<main class="content">
		<div class="content-header ui-content-header">
			<div class="container">
				<h1 class="content-heading">
                星际瘟疫                </h1>
                <p>时间限制：5s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  空间限制：128MB</p>			</div>
		</div>
		<div class="container">
			<section class="content-inner margin-top-no">
				<div class="row">
					<div class="col-lg-13 col-md-13">
						<div class="card margin-bottom-no">
							<div class="card-main">
								<div class="card-inner">
									
                                <h3>题目描述</h3><p><div>环网曾经是人类文明史上的奇迹，银河系中的无数星球被时空之门联系在一起，从此时间和空间不再是阻碍。一旦两个星球之间建立了时空联系，那么通过时空之门可以在一瞬间从一个星球到达另外一个星球。人类文明因此以前所未有的速度扩张到银河系的每个角落。</div>
<div><span class="Apple-tab-span" style="white-space:pre">	</span>在被称为末日浩劫的上古事件中，人工智能消失了，而时空之门从此再也没有响应人类的呼唤。人类文明的n个星球中，如今只剩下k个尚有人类居住，而他们只能进行简单的实时通讯，再也不能互相访问。</div>
<div><span class="Apple-tab-span" style="white-space:pre">	</span>更可怕的事情发生了，某个尚有人类居住的星球r上爆发了电子瘟疫。这种瘟疫大肆破坏人类的电子植入设备，几乎毁灭了r星。r星被毁灭之前传送过来的信息证实该电子瘟疫和上古人工智能的相似性将会允许它们通过部分上古时空之门。由于时空之门已经有几个世纪没人维护了，所以电子瘟疫利用时空之门进行的传送甚至不是双向的。</div>
<div><span class="Apple-tab-span" style="white-space:pre">	</span>为了阻止电子瘟疫，人类决定使用他们剩余的总和为w的空间能量对环网中的某个星球进行空间打击（可以是r星）。空间打击可以让一个星球彻底消失。然而由于星球的参数不同，打击每个星球需要的空间能是不一样的。人类指挥官很想知道，人类能否打击某个星球使得电子瘟疫不能到达剩下的k-1个人类居住星，如果能的话，最小需要多少空间能。注意到如果电子瘟疫本来就不能到达剩下的k-1个人类居住星，那么就不需要打击了。</div>
<div><span class="Apple-tab-span" style="white-space:pre">	</span>由于多重宇宙的存在，在不同宇宙中，k个人类居住点是不同的，为此，我们将对你进行多组询问。</div>
<p class="MsoNormal"></p>
<p></p></p><hr/><h3>输入格式</h3><p><div><span class="Apple-tab-span" style="white-space: pre;">	</span>第1行两个整数n，m，r。表示环网的星球数量、电子瘟疫尚能利用的时空连接数量以及r星的编号。</div>
<div><span class="Apple-tab-span" style="white-space: pre;">	</span>第2行到第m+1行，每行两个整数u[i]，v[i]。表示电子瘟疫可以从u[i]星利用时空之门传送到v[i]星，这个传送不是双向的。保证每个有序对u[i]，v[i]只会出现最多一次，而且不存在u[i]=v[i]。</div>
<div><span class="Apple-tab-span" style="white-space: pre;">	</span>第m+2行有n个整数e[i]，表示打击每个星球需要的空间能。</div>
<div><span class="Apple-tab-span" style="white-space: pre;">	</span>第m+3行有一个整数q。表示有q组询问。</div>
<div><span class="Apple-tab-span" style="white-space: pre;">	</span>对于每组询问，第1行有两个整数t(t=k-1)，w。表示除了r星以外尚有t个星球有人居住，w表示人类空间能总和，</div>
<div><span class="Apple-tab-span" style="white-space: pre;">	</span>接下来一行有t个数字，是这t个星球的编号。</div>
<p></p></p><hr/><h3>输出格式</h3><p><div>对于每组询问，如果人类无法阻止瘟疫到达某个人类居住星球，请输出1。否则输出最小需要的空间能。</div>
<p></p></p><hr/><h3>样例输入</h3><pre>6 7 3
4 1
1 5
3 4
2 4
3 1
1 3
1 6
3 0 8 6 1 8
3
2 9
1 2
2 0
6 2
2 4
5 2

</pre><hr/><h3>样例输出</h3><pre>8
1
3
</pre><hr/><h3>提示</h3><p><div>2&lt;=n&lt;=2*10^5</div>
<div>0&lt;=m&lt;=5*10^5</div>
<div>0&lt;=e[i]&lt;=10^9</div>
<div>1&lt;=q&lt;=5*10^5</div>
<div>1&lt;=t&lt;=n-1</div>
<div>1&lt;=&sum;t&lt;=5*10^5</div>
<div>0&lt;=w&lt;=10^9</div>
<div></div>
<p></p></p><hr/><h3>题目来源</h3><p>By Martin</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				
			</section>
		</div>
	</main>

	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light waves-effect" data-toggle="dropdown" aria-expanded="true"><span class="fbtn-text fbtn-text-left">Menu</span><span class="fbtn-ori icon">apps</span><span class="fbtn-sub icon">close</span></a>
			<div class="fbtn-dropup">
				<a class="fbtn fbtn-brand waves-attach waves-circle waves-light waves-effect" href="../list.html" target="_self"><span class="fbtn-text fbtn-text-left">题目列表</span><span class="icon">menu</span></a>
				<a class="fbtn fbtn-green waves-attach waves-circle waves-effect" href="../index.html" target="_self"><span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span></a>
				<a class="fbtn waves-attach waves-circle waves-effect" href="http://www.lydsy.com/JudgeOnline/submitpage.php?id=4157" target="_blank"><span class="fbtn-text fbtn-text-left">提交代码</span><span class="icon">send</span></a>
				<a class="fbtn fbtn-orange waves-attach waves-circle waves-effect" href="http://www.lydsy.com/JudgeOnline/wttl/wttl.php?pid=4157" target="_blank"><span class="fbtn-text fbtn-text-left">试题讨论</span><span class="icon">chat</span></a>
				
			</div>
		</div>
	</div>

	<!-- js -->
	<script src="../js/jquery.min.js"></script>
	<script src="../js/base.min.js"></script>
	<script src="../js/project.min.js"></script>
</body>
</html>